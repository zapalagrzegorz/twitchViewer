{"version":3,"sources":["scripts.js"],"names":["engine","users","getUsersData","single","self","invalidEntry","getSearchData","getStreamsData","test","$","val","attr","hide","show","validateSearchEntry","singleLw","toLowerCase","forEach","value","valueTemp","promises","promise","ajaxRequest","push","when","apply","done","handleStreamResponses","i","l","length","call","user","ajax","type","url","headers","Accept","responses","arguments","userStreams","singleQ","stream","produceOutput","handleSuccessUsers","usersData","promisesChannels","hasOwnProperty","showUnkownUsers","bio","substring","concat","created_at","logo","display_name","name","getChannelsData","profile_banner","video_banner","followers","status","typeOfUser","pic","mainDesc","launchedAt","userHTML","preview","large","game","channel","viewers","append","lastStatus","prepend","message","indexOf","replace","ready","init","click","e","removeClass","$this","hasClass","addClass","preventDefault","document","bind","pressed","executeSearch","searchValue","keyCode"],"mappings":"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","file":"scripts.js","sourcesContent":["// app makes three request to Twitch APIs\r\n// I couldn't divided function call getUsersData into seperate properties as they're not independent.\r\n// First it checks if users is streaming '/streams'. If responded positively, response data is enough for that user, and produces output.\r\n// If not, it makes another call to /users/. If there isn't such user it's enough to produce adequate output.\r\n// If users exists it makes call to corresponding /channel/ to get further data.\r\n// Reponse data is transferred to other call (/streams/ -> /users/ -> /channel/ provided it gets the result\r\n// so that it produces output only when a call is finished for that user. \r\n\r\n\"use strict\";\r\n\r\nconst engine = {\r\n\tusers: ['bobross' , 'sandexperiment', 'timsww', 'soushibo', 'streamerhouse', 'Bananasaurus_Rex', 'freecodecamp','polskiestrumyki', 'ESL_SC2', 'cretetion',  'storbeck', 'habathcx', 'RobotCaleb', 'noobs2ninjas', '123', 'kubon', ],// array of users and their channels\r\n\r\n\t// app makes three request to Twitch API\r\n\tgetUsersData: function (single) {\r\n\t\tlet self = this;\r\n\r\n\t\t// conditions made for search option \r\n\t\t// It was built later, so tried to put it into existing function\r\n\t\t// === is reserved for: \"\", [] and 0, see YDKJS I\r\n\t\tif(single === \"\" || invalidEntry(single)){\r\n\t\t\treturn;\r\n\t\t}\r\n\t\telse if(typeof(single) == \"string\"){\r\n\t\t\tgetSearchData(single);\r\n\t\t}\r\n\t\telse{\r\n\t\t\tgetStreamsData();\r\n\t\t}\r\n\r\n\r\n\t\t/******************************************** \r\n\t\t * Helper functions to execute calls to API and produce output\r\n\t\t *  \r\n\t\t * ********************************************/\r\n\r\n\t\t// tests users input for valid user entry\t\t\t\r\n\t\tfunction invalidEntry() {\r\n\t\t\tif(typeof(single) == \"string\"){\r\n\t\t\t\t// ^ begins with, * zero or more occurence, $ ends with, \\s whitespace\r\n\t\t\t\tif(!/^[a-zA-Z0-9\\s][a-zA-Z0-9_\\s]*$/.test(single)){\r\n\t\t\t\t\t$(\"#searchValue\").val(\"\");\r\n\t\t\t\t\t$(\"#searchValue\").attr(\"placeholder\", \"Invalid query\");\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfunction getSearchData(single){\r\n\t\t\t$('.user-online').hide();\r\n\t\t\t$('.user-offline').hide();\r\n\t\t\t$('.user-unavailable').hide();\r\n\t\t\t$('#searchLoading').show();\r\n\t\t\tsingle = validateSearchEntry(single);\r\n\t\t\tlet singleLw = single.toLowerCase();\r\n\t\t\tself.users.forEach(function(value) {\r\n\t\t\t\tlet valueTemp = value.toLowerCase();\r\n\t\t\t\tif(singleLw == valueTemp){\r\n\t\t\t\t\t$('#'+value).show();\r\n\t\t\t\t\t$('#searchLoading').hide();\r\n\t\t\t\t\treturn; \r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t// functions were made with array parameter for the initial users array\r\n\t\t\t// not to redefine them, put single search value into array\r\n\t\t\tlet promises = [];\r\n\t\t\tlet promise = ajaxRequest('streams', single);\r\n\t\t\tpromises.push(promise);\r\n\t\t\t\r\n\t\t\t// .when method executes once all of calls have finished\r\n\t\t\t// .apply method enables array where singular arguments expected\r\n\t\t\t// first argument '$' is made to use 'apply' \r\n\t\t\t$.when.apply($, promises)\r\n\t\t\t\t.done(handleStreamResponses);\r\n\t\t}\r\n\r\n\t\t// Handle multiple parallel ajax requests\r\n\t\tfunction getStreamsData() {\r\n\t\t\tlet promises = [];\r\n\t\t\tfor (let i = 0, l = self.users.length; i < l; i++) {\r\n\t\t\t\tlet promise = ajaxRequest('streams', self.users[i]);\r\n\t\t\t\tpromises.push(promise);\r\n\t\t\t}\r\n\t\t\t$.when.apply($, promises)\r\n\t\t\t\t.done(handleStreamResponses);\r\n\t\t}\r\n\t\r\n\t\t\r\n\t\t// create single ajax requests for each user\r\n\t\tfunction ajaxRequest(call, user) {\r\n\t\t\treturn $.ajax({\r\n\t\t\t\ttype: 'get',\r\n\t\t\t\turl: 'https://wind-bow.glitch.me/twitch-api/' + call + '/' + user,\r\n\t\t\t\theaders: {\r\n\t\t\t\t\tAccept: 'application/vnd.twitchtv.v3+json'\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tfunction handleStreamResponses() {\r\n\t\t\tlet responses = arguments, promises = [], userStreams = [], singleQ = false;\r\n\t\t\tif(responses.length == 3){\r\n\t\t\t\tresponses = [];\r\n\t\t\t\tresponses.push(arguments);\r\n\t\t\t\tsingleQ = true;\r\n\r\n\t\t\t\t// need to call function again as single value is not changed\r\n\t\t\t\tsingle = validateSearchEntry(single);\r\n\t\t\t}\r\n\t\t\tfor (let i in responses) {\r\n\t\t\t\tif (responses[i][0].stream == null && singleQ === true) {\r\n\t\t\t\t\t\r\n\t\t\t\t\t// queue calls for searched user which is not streaming\r\n\t\t\t\t\tpromises.push(ajaxRequest('users', single));\r\n\t\t\t\t}\r\n\t\t\t\telse if(responses[i][0].stream == null) {\r\n\t\t\t\t\t\r\n\t\t\t\t\t// queue calls for all users which are not streaming\r\n\t\t\t\t\tpromises.push(ajaxRequest('users', self.users[i]));\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\t// users is streaming\r\n\t\t\t\t\tuserStreams.push(responses[i][0].stream);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// show those who stream\r\n\t\t\tproduceOutput('streaming', userStreams);\r\n\r\n\t\t\t// make AJAX calls if there're users not streaming\r\n\t\t\t// For them do parallel ajax requests\r\n\t\t\tif (promises.length != 0) {\r\n\t\t\t\t$.when.apply($, promises)\r\n\t\t\t\t\t.done(handleSuccessUsers);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfunction handleSuccessUsers() {\r\n\t\t\tlet usersData = [], promisesChannels = [], responses = arguments;\r\n\t\t\tif(responses.length == 3){\r\n\t\t\t\tresponses = [];\r\n\t\t\t\tresponses.push(arguments);\r\n\t\t\t}\r\n\t\t\tfor (let i in responses) {\r\n\t\t\t\tif (responses[i][0].hasOwnProperty('error')) {\r\n\t\t\t\t\t\r\n\t\t\t\t\t// show uknown users\r\n\t\t\t\t\tshowUnkownUsers(responses[i][0]);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\r\n\t\t\t\t\t// Not streaming user exists, collect some of their data from /users/ and\r\n\t\t\t\t\t// postpone showing output until channel data will be received\r\n\t\t\t\t\t// Needs another AJAX call\r\n\t\t\t\t\tlet user = {};\r\n\t\t\t\t\tuser.bio = (responses[i][0].bio == null ? 'No bio available' : responses[i][0].bio.substring(0,140).concat('...'));\r\n\t\t\t\t\tuser.created_at = responses[i][0].created_at;\r\n\t\t\t\t\tuser.logo = (responses[i][0].logo == null ? 'img/Glitch.png' : responses[i][0].logo);\r\n\t\t\t\t\tuser.display_name = responses[i][0].display_name;\r\n\t\t\t\t\tusersData.push(user);\r\n\t\t\t\t\tpromisesChannels.push(ajaxRequest('channels', responses[i][0].name));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// only when channel data will be received, user output might be made\r\n\t\t\t// so usersData is collected and passed forward\r\n\t\t\tgetChannelsData(promisesChannels, usersData);\r\n\t\t}\r\n\r\n\t\t// @usersData array\r\n\t\tfunction getChannelsData(promises, usersData) {\r\n\t\t\t$.when.apply($, promises)\r\n\r\n\t\t\t\t// how to pass array \"usersData' to as parameter to .done?\r\n\t\t\t\t// don't know so, made local function \r\n\t\t\t\t.done(function () {\r\n\t\t\t\t\tlet responses = arguments;\r\n\t\t\t\t\tif(responses.length == 3){\r\n\t\t\t\t\t\tresponses = [];\r\n\t\t\t\t\t\tresponses.push(arguments);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (let i in responses) {\r\n\t\t\t\t\t\tusersData[i].profile_banner = (responses[i][0].video_banner == null ? 'img/profileLarge.png' : responses[i][0].video_banner);\r\n\t\t\t\t\t\tusersData[i].followers = responses[i][0].followers;\r\n\t\t\t\t\t\tusersData[i].status = (responses[i][0].status == null ? 'no status' : responses[i][0].status);\r\n\t\t\t\t\t\tif(usersData[i].status.length > 44){\r\n\t\t\t\t\t\t\tusersData[i].status = responses[i][0].status.substring(0,44).concat('...');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// show not streaming users\r\n\t\t\t\t\tproduceOutput('nostreaming', usersData);\r\n\t\t\t\t\t$('header').show();\r\n\t\t\t\t\t$('main').show();\r\n\t\t\t\t\t$('#mainLoading').hide();\r\n\t\t\t\t});\r\n\r\n\t\t}\r\n\r\n\t\t/***************************************\r\n\t\t* Functions producing output for different users \r\n\t\t*\r\n\t\t* *****************************************************/\r\n\r\n\t\tfunction produceOutput(typeOfUser, user) {\r\n\t\t\tfor(let i in user){\r\n\t\t\t\tlet pic, mainDesc, name, logo, followers, launchedAt, userHTML;\r\n\t\t\t\t\r\n\t\t\t\tif(typeOfUser == 'streaming'){\r\n\t\t\t\t\tpic = user[i].preview.large;\r\n\t\t\t\t\tmainDesc = user[i].game;\r\n\t\t\t\t\tname = user[i].channel.name;\r\n\t\t\t\t\tlogo = user[i].channel.logo;\r\n\t\t\t\t\tfollowers = user[i].channel.followers;\r\n\t\t\t\t\tlaunchedAt = (user[i].created_at).substring(0,10);\r\n\t\t\t\t\tuserHTML = '<article class=\"col-12 col-sm-12 col-md-6 col-lg-6 col-xl-6 channel user-online\" id=\"'+ name+'\"><div class=\"shadows\"><div class=\"channelPreview\"><a href=\"https://www.twitch.tv/' + name + '\" target=\"_blank\"><i class=\"fa fa-3x fa-play icon-play\" aria-hidden=\"true\"></i></a><div class=\"darken\">';\r\n\t\t\t\t}\r\n\t\t\t\telse if (typeOfUser == 'nostreaming') {\r\n\t\t\t\t\tpic = user[i].profile_banner;\r\n\t\t\t\t\tmainDesc = user[i].display_name;\r\n\t\t\t\t\tname = user[i].name;\t\r\n\t\t\t\t\tlogo = user[i].logo;\r\n\t\t\t\t\tfollowers = user[i].followers;\r\n\t\t\t\t\tlaunchedAt = user[i].created_at;\r\n\t\t\t\t\tuserHTML = '<article class=\"col-12 col-sm-12 col-md-6 col-lg-6 col-xl-6 channel user-offline\" id=\"'+ name+'\"><div class=\"shadows\"><div class=\"channelPreview\"><div>'; // extra div for darken\r\n\t\t\t\t}\r\n\t\t\t\t//  end of darken\r\n\t\t\t\tuserHTML +=\t'<img class=\"img\" src=\"'+ pic +'\"></div></div><div class=\"channelDescription\">' +\r\n\t\t\t\t\t\t\t\t\t'<h3><a href=\"https://www.twitch.tv/' + mainDesc + '\" target=\"_blank\">'+ mainDesc +'</a></h3>';\r\n\t\t\t\t\r\n\t\t\t\tif(typeOfUser == 'streaming') {\r\n\t\t\t\t\tuserHTML +=\t'<div class=\"row\"><div class=\"col-10\">' +\r\n\t\t\t\t\t\t\t\t\t\t'<h4><a href=\"https://www.twitch.tv/' + user[i].channel.name + '\" target=\"_blank\">'+ user[i].channel.status +'</a></h4></div>' +\r\n\t\t\t\t\t\t\t\t\t'<div class=\"col-2\" style=\"text-align: center\">' +\r\n\t\t\t\t\t\t\t\t\t\t'<i class=\"fa fa-2x fa-user-circle\" aria-hidden=\"true\"></i><p><span id=\"#online\">'+ user[i].viewers +'</span> online</p></div></div>';\r\n\t\t\t\t}\r\n\t\t\t\telse if(typeOfUser == 'nostreaming'){\r\n\t\t\t\t\tuserHTML += '<div class=\"row\"><div class=\"col-12\">' +\r\n\t\t\t\t\t\t\t\t\t'<p class=\"user-bio\">' + user[i].bio +'</p></div></div>';\r\n\t\t\t\t}\r\n\r\n\t\t\t\tuserHTML += '<div class=\"row\"><div class=\"col-2\" style=\"padding-right:0;\">' +\r\n\t\t\t\t\t\t\t\t'<a href=\"https://www.twitch.tv/' + name + '\" target=\"_blank\">' +\r\n\t\t\t\t\t\t\t\t\t'<img class=\"img\" src=\"'+ logo + '\"></a></div>' +\r\n\t\t\t\t\t\t\t'<div class=\"col-10\" id=\"lastStatus' + mainDesc +'\">' +\r\n\t\t\t\t\t\t\t\t'<p>followers: ' + followers + '</p>' +\r\n\t\t\t\t\t\t\t\t'<p>Launched: ' + launchedAt + '</p>' +\r\n\t\t\t\t\t\t\t'</div></div></div></div></article>';\r\n\r\n\t\t\t\t$('#streamContent').append(userHTML);\r\n\t\t\t\t\r\n\t\t\t\tif(typeOfUser == 'nostreaming'){\r\n\t\t\t\t\tvar lastStatus = '<p>Last status: '+ user[i].status + '</p>';\r\n\t\t\t\t\t$('#lastStatus' + mainDesc).prepend(lastStatus);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t$('#searchLoading').hide();\r\n\t\t}\r\n\r\n\t\tfunction showUnkownUsers(user) {\r\n\t\t\tvar userHTML = '<article class=\"col-12 col-sm-12 col-md-6 col-lg-6 col-xl-6 channel user-unavailable\"><div class=\"shadows\"><div class=\"channelPreview\">' +\r\n\t\t\t\t\t'<img class=\"img\" src=\"img/nostream.gif\"></div>' +\r\n\t\t\t\t'<div class=\"channelDescription\">' +\r\n\t\t\t\t\t'<h3>' + user.message + ' or does not exist</h3></div></div></article>';\r\n\t\t\t$('#streamContent').append(userHTML);\r\n\t\t}\r\n\t\t// function handleError(jqXHR, error, errorThrown) {\r\n\t\t// \tconsole.log(jqXHR, error, errorThrown);\r\n\t\t// \t// $('main').html(<div class=\"error\">Something went wrong</div>);    \r\n\t\t// }\r\n\t\tfunction validateSearchEntry(single) {\r\n\t\t\tif(single.indexOf(\" \") != -1){\r\n\t\t\t\treturn single.replace(/\\s/g, \"_\");\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\treturn single;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n\"use strict\";\n\n$().ready(function () {\n\n\tinit();\n\n\tengine.getUsersData();\n\n\tfunction init() {\n\t\t$('#searchLoading').hide();\n\n\t\t$('.nav-item').click(function (e) {\n\t\t\t$('.navbar li.active').removeClass('active');\n\t\t\tvar $this = $(this);\n\t\t\tif (!$this.hasClass('active')) {\n\t\t\t\t$this.addClass('active');\n\t\t\t}\n\t\t\te.preventDefault();\n\t\t});\n\n\t\t$('#all').click(function (e) {\n\t\t\te.preventDefault();\n\t\t\t$('.user-online').show();\n\t\t\t$('.user-offline').show();\n\t\t\t$('.user-unavailable').show();\n\t\t});\n\n\t\t$('#online').click(function (e) {\n\t\t\te.preventDefault();\n\t\t\t$('.user-offline').hide();\n\t\t\t$('.user-unavailable').hide();\n\t\t\t$('.user-online').show();\n\t\t});\n\n\t\t$('#offline').click(function (e) {\n\t\t\te.preventDefault();\n\t\t\t$('.user-online').hide();\n\t\t\t$('.user-unavailable').hide();\n\t\t\t$('.user-offline').show();\n\t\t});\n\n\t\t$(document).bind('keypress', pressed);\n\n\t\t$('#searchUser').click(function (e) {\n\t\t\te.preventDefault();\n\t\t\texecuteSearch();\n\t\t});\n\n\t\tfunction executeSearch() {\n\t\t\tvar searchValue = $(\"#searchValue\").val();\n\t\t\tengine.getUsersData(searchValue);\n\t\t}\n\n\t\tfunction pressed(e) {\n\t\t\tif (e.keyCode === 13) {\n\t\t\t\te.preventDefault();\n\t\t\t\texecuteSearch();\n\t\t\t}\n\t\t}\n\t}\n});\n"]}